select contest_id, hacker_id, name, sum(cts), sum(ctas), sum(ctv), sum(ctuv) from ( select c.contest_id, c.hacker_id, c.name, vs.ctv, vs.ctuv, ss.cts, ss.ctas from contests c join colleges cg on c.contest_id = cg.contest_id join challenges cgs on cg.college_id = cgs.college_id left join (select challenge_id, sum(total_views) as ctv, sum(total_unique_views) as ctuv from view_stats group by challenge_id) vs on cgs.challenge_id = vs.challenge_id left join (select challenge_id, sum(total_submissions) as cts, sum(total_accepted_submissions) as ctas from submission_stats group by challenge_id) ss on cgs.challenge_id = ss.challenge_id ) z where coalesce(z.cts,z.ctas,z.ctv,z.ctuv) is not null group by z.contest_id, z.hacker_id, z.name order by z.contest_id;
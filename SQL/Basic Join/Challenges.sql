SELECT h.hacker_id, h.name, count(c.challenge_id) AS chall FROM hackers h JOIN challenges c ON h.hacker_id=c.hacker_id GROUP BY h.hacker_id HAVING chall= (SELECT count(challenge_id) AS ch FROM challenges GROUP BY hacker_id ORDER BY ch DESC LIMIT 1) OR chall in ( SELECT ch FROM (SELECT hacker_id, challenge_id, count(challenge_id) AS ch FROM challenges GROUP BY hacker_id) l GROUP BY ch HAVING count(ch)=1) ORDER BY chall DESC, h.hacker_id ;